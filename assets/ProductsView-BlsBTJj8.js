import{_ as P,o as a,c as l,a as e,n as _,w as $,F as b,d as L,t as d,e as I,m as V,f,g as h,h as y,i as q,j as x,v as E,b as u,k as w,r as m,l as M,L as R,p as Q}from"./index-C3yE7Zfh.js";import{c as v}from"./cartStore-lkYKq-id.js";import{s as C}from"./statusStore-DB83GcS-.js";const D={props:["pages","updatePage"]},j={"aria-label":"Page navigation example"},N={class:"pagination justify-content-center"},B=e("span",{"aria-hidden":"true"},"«",-1),O=[B],H=["onClick"],z=e("span",{"aria-hidden":"true"},"»",-1),F=[z];function G(t,o,n,T,r,g){return a(),l("nav",j,[e("ul",N,[e("li",{class:_(["page-item",{disabled:n.pages.has_pre===!1,invisible:n.pages.has_pre===!1}])},[e("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:o[0]||(o[0]=$(c=>n.updatePage(n.pages.current_page-1),["prevent"]))},O)],2),(a(!0),l(b,null,L(n.pages.total_pages,c=>(a(),l("li",{class:_(["page-item",{disabled:n.pages.current_page===c}]),key:c},[e("a",{class:"page-link",href:"#",onClick:$(p=>n.updatePage(c),["prevent"])},d(c),9,H)],2))),128)),e("li",{class:_(["page-item",{disabled:n.pages.has_next===!1,invisible:n.pages.has_next===!1}])},[e("a",{class:"page-link",href:"#","aria-label":"Next",onClick:o[1]||(o[1]=$(c=>n.updatePage(n.pages.current_page+1),["prevent"]))},F)],2)])])}const J=P(D,[["render",G]]);var K={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"jeff_hexschool",BASE_URL:"/PorkShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:W,VITE_PATH:X}=K,S=C(),Y={data(){return{userModal:null,editCarts:{},form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{sendOrder(){this.isLoading=!0;let t=`${W}/api/${X}/order`;const o=this.form;I.post(t,{data:o}).then(n=>{this.$refs.form.resetForm(),this.isLoading=!1,n.data.success?(this.getCarts(),S.pushMessage({style:"success",title:"已送出訂單"})):S.pushMessage({danger:"success",title:"送出訂單失敗",content:n.data.message.join("、")})})},isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"電話為必填，須為有效的電話號碼"},...V(v,["getCarts","addToCart","cartChangeQty","delCartItem","delAllCart"])},watch:{},mounted(){},computed:{...f(v,["carts","cartslength"]),...f(C,["addCartLoading","cartQtyLoading","delCart"])}},Z={class:"text-end"},ee=["disabled"],se={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},te={class:"table align-middle"},oe=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"170px"}},"數量/單位"),e("th",{style:{width:"120px"}}),e("th",null,"單價"),e("th",null,"小計")])],-1),ae=["onClick","disabled"],le={key:0,class:"bi bi-x-lg"},ne={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},ie={class:"input-group input-group-sm"},de={class:"input-group mb-3"},re=["disabled","onClick"],ce=["onUpdate:modelValue","disabled"],ue=["onClick","disabled"],pe={class:"input-group-text",id:"basic-addon2"},_e=e("td",null,null,-1),he={class:"text-end"},me={key:0},ge=e("small",{class:"text-success"},"折扣價：",-1),fe={key:1},be={key:0,class:"text-end"},ye={key:1,class:"text-end"},ve=e("td",{colspan:"5",class:"text-end"},"總計",-1),Ce={class:"text-end"},ke={key:0},$e=e("td",{colspan:"5",class:"text-end text-success"},"折扣價",-1),Ve={class:"text-end text-success"},Pe={class:"my-5 row justify-content-center"},Le={class:"mb-3"},Te=e("label",{for:"email",class:"form-label"},"Email",-1),xe={class:"mb-3"},Ee=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),Se={class:"mb-3"},Ue=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),Ae={class:"mb-3"},Ie=e("label",{for:"address",class:"form-label"},"收件人地址",-1),qe={class:"mb-3"},we=e("label",{for:"message",class:"form-label"},"留言",-1),Me={class:"text-end"},Re=["disabled"];function Qe(t,o,n,T,r,g){const c=m("v-field"),p=m("error-message"),k=m("v-form");return a(),l(b,null,[e("div",Z,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:o[0]||(o[0]=(...s)=>t.delAllCart&&t.delAllCart(...s)),disabled:t.delCart==="delAll"},[t.delCart==="delAll"?(a(),l("span",se)):h("",!0),y(" 清空購物車 ")],8,ee)]),e("table",te,[oe,e("tbody",null,[(a(!0),l(b,null,L(t.carts.carts,s=>(a(),l("tr",{key:s.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:i=>t.delCartItem(s.id),disabled:s.id===t.delCart},[s.id!==t.delCart?(a(),l("i",le)):h("",!0),s.id===t.delCart?(a(),l("span",ne)):h("",!0)],8,ae)]),e("td",null,d(s.product.title),1),e("td",null,[e("div",ie,[e("div",de,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",style:q(s.qty===1?"display:none;":""),disabled:s.qty===1||s.id===t.cartQtyLoading,onClick:i=>(s.qty--,t.cartChangeQty(s,s.qty,"--"))}," - ",12,re),x(e("input",{min:"1",type:"number",class:"form-control",style:{"text-align":"center"},"onUpdate:modelValue":i=>s.qty=i,disabled:s.id===t.cartQtyLoading,readonly:""},null,8,ce),[[E,s.qty]]),e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:i=>(s.qty++,t.cartChangeQty(s,s.qty,"++")),disabled:s.id===t.cartQtyLoading}," + ",8,ue),e("span",pe,d(s.product.unit),1)])])]),_e,e("td",he,[s.product.price<s.product.origin_price?(a(),l("div",me,[ge,e("del",null,d(s.product.origin_price),1),y(" "+d(s.product.price),1)])):(a(),l("div",fe,d(s.product.origin_price),1))]),s.product.price<s.product.origin_price?(a(),l("td",be,d(s.product.price*s.qty),1)):(a(),l("td",ye,d(s.product.origin_price*s.qty),1))]))),128))]),e("tfoot",null,[e("tr",null,[ve,e("td",Ce,d(t.carts.total),1)]),t.carts.final_total<t.carts.total?(a(),l("tr",ke,[$e,e("td",Ve,d(t.carts.final_total),1)])):h("",!0)])]),e("div",Pe,[u(k,{ref:"form",class:"col-md-6",onSubmit:g.sendOrder},{default:w(({errors:s})=>[e("div",Le,[Te,u(c,{id:"email",name:"email",type:"email",class:_(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:r.form.user.email,"onUpdate:modelValue":o[1]||(o[1]=i=>r.form.user.email=i)},null,8,["class","modelValue"]),u(p,{name:"email",class:"invalid-feedback"})]),e("div",xe,[Ee,u(c,{id:"name",name:"姓名",type:"text",class:_(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:r.form.user.name,"onUpdate:modelValue":o[2]||(o[2]=i=>r.form.user.name=i)},null,8,["class","modelValue"]),u(p,{name:"姓名",class:"invalid-feedback"})]),e("div",Se,[Ue,u(c,{id:"tel",name:"電話",type:"text",class:_(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:g.isPhone,modelValue:r.form.user.tel,"onUpdate:modelValue":o[3]||(o[3]=i=>r.form.user.tel=i)},null,8,["class","rules","modelValue"]),u(p,{name:"電話",class:"invalid-feedback"})]),e("div",Ae,[Ie,u(c,{id:"address",name:"地址",type:"text",class:_(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:r.form.user.address,"onUpdate:modelValue":o[4]||(o[4]=i=>r.form.user.address=i)},null,8,["class","modelValue"]),u(p,{name:"地址",class:"invalid-feedback"})]),e("div",qe,[we,x(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":o[5]||(o[5]=i=>r.form.message=i)},null,512),[[E,r.form.message]])]),e("div",Me,[e("button",{type:"submit",class:"btn btn-danger",disabled:r.form.user.id===t.cartQtyLoading}," 送出訂單 ",8,Re)])]),_:1},8,["onSubmit"])])],64)}const De=P(Y,[["render",Qe]]);var je={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"jeff_hexschool",BASE_URL:"/PorkShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Ne,VITE_PATH:Be}=je,U=C(),A=M("productStore",{state:()=>({products:[],pages:{}}),actions:{getProducts(t=1){U.isLoading=!0;let o=`${Ne}/api/${Be}/products?page=${t}`;I.get(o).then(n=>{this.products=n.data.products,this.pages=n.data.pagination}).catch(()=>{this.products=[],this.pages={}}),U.isLoading=!1}}}),Oe={data(){return{tempProduct:{},selectID:"",checkProduct:"",isActive:"all",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{openModal(t){this.$refs.uModal.openModal(),this.checkProduct=t.id,this.tempProduct={...t},setTimeout(()=>{this.checkProduct=""},200)},...V(A,["getProducts"]),...V(v,["getCarts","addToCart","cartChangeQty","delCartItem","delAllCart"])},created(){},mounted(){this.getProducts(),this.getCarts()},components:{Loading:R,Pagination:J,UserCart:De},computed:{...f(A,["products","pages"]),...f(v,["carts","cartslength"]),...f(C,["isLoading","addCartLoading","cartQtyLoading","setIsLoading","delCart"])}},He={class:"container"},ze={class:"mt-4"},Fe=e("h2",{class:"d-flex justify-content-center",style:{"margin-top":"75px"}},"商品列表",-1),Ge={class:"row d-flex list-unstyled"},Je={class:"img-fluid hovereffect px-3",style:{"background-size":"cover","background-position":"center",width:"100%",height:"250px"}},Ke=["src","alt","title"],We={class:"overlay",style:{"margin-top":"100px"}},Xe=["disabled","onClick"],Ye={class:"py-1",style:{"text-align":"center"}},Ze={class:"products-title m-0",role:"button"},es={key:0,class:"products-title mt-1",role:"button"},ss={class:"small"},ts={class:"small",style:{color:"red"}},os={key:1,class:"products-title mt-1",role:"button"},as={class:"small"},ls=["disabled","onClick"],ns=e("i",{class:"fas fa-spinner fa-pulse"},null,-1),is={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function ds(t,o,n,T,r,g){const c=m("Loading"),p=m("Pagination"),k=m("UserCart");return a(),l(b,null,[u(c,{active:t.isLoading},null,8,["active"]),e("div",He,[e("div",ze,[Fe,e("ul",Ge,[(a(!0),l(b,null,L(t.products,s=>(a(),l("li",{class:"col-lg-4 col-md-8",key:s.id},[e("div",Je,[e("img",{class:"img-responsive",style:{width:"100%",height:"100%"},src:s.imageUrl,alt:s.title,title:s.title+":"+s.description},null,8,Ke),e("div",We,[e("h2",null,d(s.title),1),e("a",{href:"#",type:"button",class:"info",disabled:s.id===r.checkProduct,onClick:i=>g.openModal(s)}," 查看更多 ",8,Xe)])]),e("div",Ye,[e("p",Ze,d(s.title),1),s.price<s.origin_price?(a(),l("p",es,[e("del",ss,"$ "+d(s.origin_price),1),y(" 現在只要  "),e("span",ts,"$ "+d(s.price),1)])):(a(),l("p",os,[e("span",as,"$ "+d(s.origin_price),1)])),e("button",{type:"button",class:"btn btn-outline-secondary btn-sm mx-auto fs-6",disabled:s.id===t.addCartLoading,onClick:i=>t.addToCart(s.id,1)},[ns,s.id===t.addCartLoading?(a(),l("span",is)):h("",!0),y(" 加入購物車 ")],8,ls)])]))),128))]),u(p,{pages:t.pages,"update-page":t.getProducts},null,8,["pages","update-page"]),t.cartslength>0?(a(),Q(k,{key:0})):h("",!0)])])],64)}const ps=P(Oe,[["render",ds]]);export{ps as default};
