import{a as T,m as k,e as g,_ as E,o as n,c as a,b as e,f as m,g as y,F as v,h as S,t as i,n as A,w as V,v as $,d as c,i as I,j as f,r as h,k as q,L as w,l as R}from"./index-D2w1bL17.js";import{c as C,s as U}from"./cartStore-Br0fGViy.js";var Q={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"jeff_hexschool",BASE_URL:"/PorkShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:D,VITE_PATH:M}=Q,B={data(){return{userModal:null,editCarts:{},status:{checkProduct:""},form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{sendOrder(){this.isLoading=!0;let t=`${D}/api/${M}/order`;const l=this.form;T.post(t,{data:l}).then(u=>{this.$refs.form.resetForm(),this.isLoading=!1,u.data.success&&this.getCarts()})},isPhone(t){return/^(09)[0-9]{8}$/.test(t)?!0:"電話為必填，須為有效的電話號碼"},...k(C,["getCarts","addToCart","cartChangeQty","delCartItem","delAllCart"])},watch:{},mounted(){},computed:{...g(C,["carts","cartslength","addCartLoading","cartQtyLoading","delCart"])}},N={class:"text-end"},O=["disabled"],j={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},H={class:"table align-middle"},z=e("thead",null,[e("tr",null,[e("th"),e("th",null,"品名"),e("th",{style:{width:"170px"}},"數量/單位"),e("th",{style:{width:"120px"}}),e("th",null,"單價"),e("th",null,"小計")])],-1),F=["onClick","disabled"],G={key:0,class:"bi bi-x-lg"},J={key:1,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},K={class:"input-group input-group-sm"},W={class:"input-group mb-3"},X=["disabled","onClick"],Y=["onUpdate:modelValue","disabled"],Z=["onClick","disabled"],ee={class:"input-group-text",id:"basic-addon2"},se=e("td",null,null,-1),te={class:"text-end"},oe={key:0},le=e("small",{class:"text-success"},"折扣價：",-1),ne={key:1},ae={key:0,class:"text-end"},de={key:1,class:"text-end"},ie=e("td",{colspan:"5",class:"text-end"},"總計",-1),re={class:"text-end"},ce={key:0},ue=e("td",{colspan:"5",class:"text-end text-success"},"折扣價",-1),_e={class:"text-end text-success"},pe={class:"my-5 row justify-content-center"},me={class:"mb-3"},he=e("label",{for:"email",class:"form-label"},"Email",-1),be={class:"mb-3"},fe=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ge={class:"mb-3"},ye=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),ve={class:"mb-3"},Ce=e("label",{for:"address",class:"form-label"},"收件人地址",-1),ke={class:"mb-3"},Ve=e("label",{for:"message",class:"form-label"},"留言",-1),$e={class:"text-end"},Le=["disabled"];function Pe(t,l,u,x,r,b){const _=h("v-field"),p=h("error-message"),o=h("v-form");return n(),a(v,null,[e("div",N,[e("button",{class:"btn btn-outline-danger",type:"button",onClick:l[0]||(l[0]=(...s)=>t.delAllCart&&t.delAllCart(...s)),disabled:t.delCart==="delAll"},[t.delCart==="delAll"?(n(),a("span",j)):m("",!0),y(" 清空購物車 ")],8,O)]),e("table",H,[z,e("tbody",null,[(n(!0),a(v,null,S(t.carts.carts,s=>(n(),a("tr",{key:s.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:d=>t.delCartItem(s.id),disabled:s.id===t.delCart},[s.id!==t.delCart?(n(),a("i",G)):m("",!0),s.id===t.delCart?(n(),a("span",J)):m("",!0)],8,F)]),e("td",null,i(s.product.title),1),e("td",null,[e("div",K,[e("div",W,[e("button",{type:"button",class:"btn btn-outline-primary btn-sm",style:A(s.qty===1?"display:none;":""),disabled:s.qty===1||s.id===t.cartQtyLoading,onClick:d=>(s.qty--,t.cartChangeQty(s,s.qty))}," - ",12,X),V(e("input",{min:"1",type:"number",class:"form-control",style:{"text-align":"center"},"onUpdate:modelValue":d=>s.qty=d,disabled:s.id===t.cartQtyLoading,readonly:""},null,8,Y),[[$,s.qty]]),e("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:d=>(s.qty++,t.cartChangeQty(s,s.qty)),disabled:s.id===t.cartQtyLoading}," + ",8,Z),e("span",ee,i(s.product.unit),1)])])]),se,e("td",te,[s.product.price<s.product.origin_price?(n(),a("div",oe,[le,e("del",null,i(s.product.origin_price),1),y(" "+i(s.product.price),1)])):(n(),a("div",ne,i(s.product.origin_price),1))]),s.product.price<s.product.origin_price?(n(),a("td",ae,i(s.product.price*s.qty),1)):(n(),a("td",de,i(s.product.origin_price*s.qty),1))]))),128))]),e("tfoot",null,[e("tr",null,[ie,e("td",re,i(t.carts.total),1)]),t.carts.final_total<t.carts.total?(n(),a("tr",ce,[ue,e("td",_e,i(t.carts.final_total),1)])):m("",!0)])]),e("div",pe,[c(o,{ref:"form",class:"col-md-6",onSubmit:b.sendOrder},{default:I(({errors:s})=>[e("div",me,[he,c(_,{id:"email",name:"email",type:"email",class:f(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:r.form.user.email,"onUpdate:modelValue":l[1]||(l[1]=d=>r.form.user.email=d)},null,8,["class","modelValue"]),c(p,{name:"email",class:"invalid-feedback"})]),e("div",be,[fe,c(_,{id:"name",name:"姓名",type:"text",class:f(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:r.form.user.name,"onUpdate:modelValue":l[2]||(l[2]=d=>r.form.user.name=d)},null,8,["class","modelValue"]),c(p,{name:"姓名",class:"invalid-feedback"})]),e("div",ge,[ye,c(_,{id:"tel",name:"電話",type:"text",class:f(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:b.isPhone,modelValue:r.form.user.tel,"onUpdate:modelValue":l[3]||(l[3]=d=>r.form.user.tel=d)},null,8,["class","rules","modelValue"]),c(p,{name:"電話",class:"invalid-feedback"})]),e("div",ve,[Ce,c(_,{id:"address",name:"地址",type:"text",class:f(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:r.form.user.address,"onUpdate:modelValue":l[4]||(l[4]=d=>r.form.user.address=d)},null,8,["class","modelValue"]),c(p,{name:"地址",class:"invalid-feedback"})]),e("div",ke,[Ve,V(e("textarea",{id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":l[5]||(l[5]=d=>r.form.message=d)},null,512),[[$,r.form.message]])]),e("div",$e,[e("button",{type:"submit",class:"btn btn-danger",disabled:r.form.user.id===t.cartQtyLoading}," 送出訂單 ",8,Le)])]),_:1},8,["onSubmit"])])],64)}const Te=E(B,[["render",Pe]]);var Ee={VITE_URL:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"jeff_hexschool",BASE_URL:"/PorkShop/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_URL:Se,VITE_PATH:Ue}=Ee,L=U(),P=q("productStore",{stste:()=>({products:[],pages:{}}),actions:{getProducts(t=1){L.isLoading=!0;let l=`${Se}/api/${Ue}/products?page=${t}`;T.get(l).then(u=>{this.products=u.data.products,this.pages=u.data.pagination}).catch(()=>{this.products=[],this.pages={}}),L.isLoading=!1}}}),xe={data(){return{tempProduct:{},selectID:"",status:{checkProduct:""},isActive:"all",form:{user:{name:"",email:"",tel:"",address:""},message:""}}},methods:{openModal(t){this.$refs.uModal.openModal(),this.status.checkProduct=t.id,this.tempProduct={...t},setTimeout(()=>{this.status.checkProduct=""},200)},...k(P,["getProducts"]),...k(C,["getCarts","addToCart","cartChangeQty","delCartItem","delAllCart"])},created(){},mounted(){this.getProducts(),this.getCarts()},components:{Loading:w,UserCart:Te},computed:{...g(P,["products","pages"]),...g(C,["carts","cartslength","addCartLoading","cartQtyLoading","setIsLoading","delCart"]),...g(U,["isLoading"])}},Ae={class:"container"},Ie={class:"mt-4"},qe=e("h2",{class:"d-flex justify-content-center",style:{"margin-top":"75px"}},"商品列表",-1),we={class:"row d-flex list-unstyled"},Re={class:"img-fluid hovereffect px-3",style:{"background-size":"cover","background-position":"center",width:"100%",height:"250px"}},Qe=["src","alt","title"],De={class:"overlay",style:{"margin-top":"100px"}},Me=["disabled","onClick"],Be={class:"py-1",style:{"text-align":"center"}},Ne={class:"products-title m-0",role:"button"},Oe={key:0,class:"products-title mt-1",role:"button"},je={class:"small"},He={class:"small",style:{color:"red"}},ze={key:1,class:"products-title mt-1",role:"button"},Fe={class:"small"},Ge=["disabled","onClick"],Je=e("i",{class:"fas fa-spinner fa-pulse"},null,-1),Ke={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"};function We(t,l,u,x,r,b){const _=h("Loading"),p=h("UserCart");return n(),a(v,null,[c(_,{active:t.isLoading},null,8,["active"]),e("div",Ae,[e("div",Ie,[qe,e("ul",we,[(n(!0),a(v,null,S(t.products,o=>(n(),a("li",{class:"col-lg-4 col-md-8",key:o.id},[e("div",Re,[e("img",{class:"img-responsive",style:{width:"100%",height:"100%"},src:o.imageUrl,alt:o.title,title:o.title+":"+o.description},null,8,Qe),e("div",De,[e("h2",null,i(o.title),1),e("a",{href:"#",type:"button",class:"info",disabled:o.id===r.status.checkProduct,onClick:s=>b.openModal(o)}," 查看更多 ",8,Me)])]),e("div",Be,[e("p",Ne,i(o.title),1),o.price<o.origin_price?(n(),a("p",Oe,[e("del",je,"$ "+i(o.origin_price),1),y(" 現在只要  "),e("span",He,"$ "+i(o.price),1)])):(n(),a("p",ze,[e("span",Fe,"$ "+i(o.origin_price),1)])),e("button",{type:"button",class:"btn btn-outline-secondary btn-sm mx-auto fs-6",disabled:o.id===t.addCartLoading,onClick:s=>t.addToCart(o.id,1)},[Je,o.id===t.addCartLoading?(n(),a("span",Ke)):m("",!0),y(" 加入購物車 ")],8,Ge)])]))),128))]),t.cartslength>0?(n(),R(p,{key:0})):m("",!0)])])],64)}const Ze=E(xe,[["render",We]]);export{Ze as default};
